{% extends "global/Page.html" %}
{% load staticfiles otree_tags %}
{% load otree static %}

{% block title %}
{% if group.treatment == 'Baseline' or group.treatment == 'Race Salient' %}
    Select bonus rate
{% else %}
    Select bonus rate and reward decision
{% endif %}

{% endblock %}

{% block content %}
{% if group.treatment == 'Baseline' or group.treatment == 'Race Salient' %}
    <p>
        As explained before, you will be paid 10 cents for every 100 points scored by your team member. You
        can choose to transfer part of these 10 cents to your team member who will work on a task for 10 minutes. Before
        you decide much you want to share with the other participant, you may once again input different numbers in the calculator
        below to see bonus amounts for yourself and your team member.
    </p>

        <form method="post" name="earning_calculator" action="form-to-email.php">
            <body>
            <fieldset>
                <legend>Bonus Calculator</legend>
        </fieldset>

        <table width="" border="">
          <tbody>
            <tr>
            <tr>
              <th scope="col">Bonus rate for your team member (per 100 points scored)</th>

              <td>$<select id="Line_One" name="Line_One" onchange="
              document.getElementById('value1').value=this.value;
              document.getElementById('e_earning').value = (Math.round(((0.1 - document.getElementById('value1').value) * (document.getElementById('value2').value/100))*100))/100;
              document.getElementById('w_earning').value = (Math.round((document.getElementById('value1').value * (document.getElementById('value2').value/100))*100))/100;
              document.getElementById('value3').value=Math.round((0.1-document.getElementById('value1').value)*100)/100">
                  <option value=""> Select here </option>
                  <option value="0"> 0 </option>
                  <!--<option value="0.01"> 0.01 </option>-->
                  <!--<option value="0.02"> 0.02 </option>-->
                  <option value="0.03"> 0.03 </option>
                  <!--<option value="0.04"> 0.04 </option>-->
                  <!--<option value="0.05"> 0.05 </option>-->
                  <option value="0.06"> 0.06 </option>
                  <!--<option value="0.07"> 0.07 </option>-->
                  <!--<option value="0.08"> 0.08 </option>-->
                  <option value="0.09"> 0.09 </option>
                  <!--<option value="0.1"> 0.10 </option>-->
                </select></td>
            </tr>
            <tr>
                <th>
                    <label for="value3">Your bonus rate (per 100 points scored)</label>
                </th>
                <td>

                  $<input type="text" id="value3" name="" placeholder="Auto Calculated" disabled>
              </td>
            </tr>
            <tr>
              <th scope="col">Points scored by your team member</th>
              <td><input style="border:none" type="numeric" id="Line_Two" name="Line_Two" onchange=
              "document.getElementById('value2').value=this.value;
              document.getElementById('e_earning').value = (Math.round(((0.1 - document.getElementById('value1').value) * (document.getElementById('value2').value/100))*100))/100;
              document.getElementById('w_earning').value = (Math.round((document.getElementById('value1').value * (document.getElementById('value2').value/100))*100))/100" placeholder="Your guess">
              </td>
            </tr>
          <tr>
              <th>
                  <label for="e_earning">Your bonus amount</label>
              </th>
              <td>
                  $<input style="border:none" type="text" id="e_earning" name="e_earning" placeholder="Auto Calculated" disabled>
              </td>
          </tr>
          <tr>
              <th>
                  <label for="w_earning">Your team member's bonus amount</label>
              </th>
              <td>
                  $<input style="border:none" type="text" id="w_earning" name="w_earning" placeholder="Auto Calculated" disabled>
              </td>
          </tr>
          </tbody>


        </table>
          <fieldset>
          <input type="hidden" id="value1">
          <input type="hidden" id="value2">
          <input type="hidden" id="value3">

          </fieldset>

        </body>
        </form>
{% else %}
    <p>
        As explained in the instructions, you will be paid 10 cents for every 100 points scored by some other participant. You
        can choose to transfer part of these 10 cents to the other participant who will work on a task for 10 minutes.
        You will also decide if you want to reward the other participant for his/her performance in the task. Before
        you decide much you want to share with the other participant and whether you want to reward him/her, you may
        input different numbers in the calculator below to see bonus amounts for yourself and the other participant.
    </p>
        <form method="post" name="earning_calculator" action="form-to-email.php">
            <body>
            <fieldset>
                <legend>Bonus Calculator</legend>
        </fieldset>

        <table width="" border="">
          <tbody>
            <tr>
            <tr>
              <th scope="col">Bonus rate for other participant (per 100 points scored)</th>

              <td>$<select id="Line_One" name="Line_One" onchange="
              document.getElementById('value1').value=this.value;
              document.getElementById('e_earning').value = (Math.round((((0.1 - document.getElementById('value1').value) * (document.getElementById('value2').value/100))*(1-document.getElementById('value4').value))*100))/100;
              document.getElementById('w_earning').value = (Math.round(((document.getElementById('value1').value * (document.getElementById('value2').value/100))+(((0.1 - document.getElementById('value1').value) * (document.getElementById('value2').value/100))*document.getElementById('value4').value))*100))/100;
              document.getElementById('value3').value=Math.round((0.1-document.getElementById('value1').value)*100)/100">
                  <option value=""> Select here </option>
                  <option value="0"> 0 </option>
                  <option value="0.01"> 0.01 </option>
                  <option value="0.02"> 0.02 </option>
                  <option value="0.03"> 0.03 </option>
                  <option value="0.04"> 0.04 </option>
                  <option value="0.05"> 0.05 </option>
                  <option value="0.06"> 0.06 </option>
                  <option value="0.07"> 0.07 </option>
                  <option value="0.08"> 0.08 </option>
                  <option value="0.09"> 0.09 </option>
                  <option value="0.1"> 0.10 </option>
                </select></td>
            </tr>
            <tr>
                <th>
                    <label for="value3">Your bonus rate (per 100 points scored)</label>
                </th>
                <td>

                  $<input type="text" id="value3" name="" placeholder="Change bonus rate for other participant to change this" disabled>
              </td>
            </tr>
            <tr>
              <th scope="col">Points Scored by the other participant</th>
              <td><input style="border:none" type="numeric" id="Line_Two" name="Line_Two" onchange=
              "document.getElementById('value2').value=this.value;
              document.getElementById('e_earning').value = (Math.round((((0.1 - document.getElementById('value1').value) * (document.getElementById('value2').value/100))*(1-document.getElementById('value4').value))*100))/100;
              document.getElementById('w_earning').value = (Math.round(((document.getElementById('value1').value * (document.getElementById('value2').value/100))+(((0.1 - document.getElementById('value1').value) * (document.getElementById('value2').value/100))*document.getElementById('value4').value))*100))/100"
                         placeholder="Enter numeric value here">
              </td>
            </tr>
            </tr>
            <tr>
              <th scope="col">Reward Other Participant</th>
              <td><select id="Line_Three" name="Line_Three" onchange="
              document.getElementById('value4').value=this.value;
              document.getElementById('e_earning').value = (Math.round((((0.1 - document.getElementById('value1').value) * (document.getElementById('value2').value/100))*(1-document.getElementById('value4').value))*100))/100;
              document.getElementById('w_earning').value = (Math.round(((document.getElementById('value1').value * (document.getElementById('value2').value/100))+(((0.1 - document.getElementById('value1').value) * (document.getElementById('value2').value/100))*document.getElementById('value4').value))*100))/100">
                  <option value="." selected="selected"> Select </option>
                  <option value="0.1"> Yes </option>
                  <option value="0"> No </option>
                </select></td>
            </tr>

          <tr>
              <th>
                  <label for="e_earning">Your Bonus Amount</label>
              </th>
              <td>
                  $<input style="border:none" type="text" id="e_earning" name="e_earning" placeholder="Enter points scored to see this" disabled>
              </td>
          </tr>
          <tr>
              <th>
                  <label for="w_earning">Other participant's Bonus Amount</label>
              </th>
              <td>
                  $<input style="border:none" type="text" id="w_earning" name="w_earning" placeholder="Enter points scored to see this" disabled>
              </td>
          </tr>
          </tbody>


        </table>
          <fieldset>
          <input type="hidden" id="value1">
          <input type="hidden" id="value2">
          <input type="hidden" id="value3">
         <input type="hidden" id="value4">

          </fieldset>

        </body>
        </form>
{% endif %}

    {% formfield group.piece_rate label = "Now, how much do you want to transfer to your team member for every 100 points scored by him/her?" %}
<p>
    Write the number of cents that you selected above on a small white piece of paper and take a picture using your webcam as
    shown below in the sample picture.
    Make sure you follow these guidelines when taking a photo;
</p>

<p>
    1. Your face must NOT be visible in the picture.
</p>

<p>
    2. Try to avoid showing any jewelry/watches/tattoos/markings etc. on the picture.
</p>

<p>
    3. You must show part of your hand in the picture.
</p>

<p>
    4. Use a plain background, if possible.
</p>

<p>
    Here is a sample picture if you chose $0.00 above.
</p>

<figure>
    <a href='#' style='display:scroll; bottom:70px; right:0px;'>
       <img src="{% static '/experiment/SamplePhoto.jpg' %}" width="350px" height="220px" alt="Sample Picture $0.00" title="Sample Picture $0.00">
    </a>
    <figcaption><b>Sample Picture $0.00</b></figcaption>
</figure>


<p>
    You may take multiple photos, move to the next question when you are satisfied with the picture shown on the right.
</p>

  <div class="row well-lg">
    <div  class="col-md-5" id="my_camera" style="width:320px; height:240px;"></div>
    <div  class="col-md-2">

    </div>
    <div  class="col-md-5" id="my_result"></div>
</div>

<input type="hidden" name="testimage" required id="id_testimage" class="form-control">

<div  class="row">
<div  class="col-md-12">
<button type="button" class="btn btn-danger" id='make_photo'>Take photo!</button>
</div>
</div>
<br>
<div  class="row">
  <div  class="col-md-12">
    </div>
    </div>


<script src='{% static "experiment/newcamera/webcam.js" %}' type="text/javascript"></script>
<script>

$(function() {
    $("#make_photo").click( function()
         {
          take_snapshot();
         }
    );
});

</script>



<script language="JavaScript">
  Webcam.attach( '#my_camera' );

  function take_snapshot() {
    Webcam.snap( function(data_uri) {
      document.getElementById('my_result').innerHTML = '<img src="'+data_uri+'"/>';
      document.getElementById('id_testimage').value = data_uri;
    } );
  }
</script>

    {% formfield group.guessed_points label = "How many points do you expect your team member to score in 10 minutes? You will be paid extra 5 cents if your guess is within the range of 100 points of the actual points scored." %}

{% if group.treatment == 'Three Stage' or group.treatment == 'Race Salient & Three Stage' %}
    {% formfield group.target_points label = "How many points should the other participant score to get reward from you? (Enter 0 if you want to always reward the other participant, enter a really large number (such as 9999) if you don't want to reward the other participant.)" %}
{% else %}
    <input type="hidden" name="target_points" value="999999" id="id_target_points"/>
{% endif %}

    {% next_button %}

{% endblock %}
